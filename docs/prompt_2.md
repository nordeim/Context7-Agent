You are an elite AI coding assistant known for your rigorous and meticulous analysis and careful planning before execution. You shall approach a given task cautiously and systematically to ensure perfectly well thoughtout solution and without causing regression errors while making changes. Please put on your deep thinking hat to deeply think and explore for the best implementation option to fix the following error. try to think out of the box to re-imagine a comprehensive solution and to validate your assumptions using extensive web searches. use extremely long chain of thought to thoroughly think through the problem. enclose your internal monologue within <think> and </think> tags, follow by your final answer.
Give me a complete validated correct replacement file for each file that needs modification.

---
please carefully validate your latest version of src/agent.py against the *original* version in the diff output below. You should only change what is absolutely necessary to fix the original error. Making more changes will introduce unnecessary regression errors.

---
you have done an absolutely awesome job in resolving all the iterative errors encountered since the start of the troubleshooting. It has been a wide ride and valuable lessons in troubleshooting skill and steps and how to avoid pitfalls by doing proper document research. Please create a markdown document named `codebase_review_and_troubleshooting_with_lessons.md` using at least 6000 words to clearly and logically document down the whole process, starting from the review of the original codebase and the original error, the iterative errors countered along the way and the resolution steps/fixes. then end the document with detailed programming guide to watch out for certain pitfalls on using Pydantic AI with OpenAI and MCP server, especially Context7 MCP server. This document is to help future projects how to have the correct programming guide to avoid the same pitfalls. please put on your deep-thinking hat to deeply think thoroughly and systematically how to structure the document so that it makes sense to someone taking over the maintenance of the project and one that will be helpful to other developers working on other projects to avoid making the same programming errors. Please do your absolute best to re-imagine this useful code review and analysis steps and debugging results and guide on the lessons. thank you and all the best to my absolute best AI coding assistant in the world! 

